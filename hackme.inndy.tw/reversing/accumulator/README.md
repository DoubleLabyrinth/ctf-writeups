# hackme.inndy.tw --- reversing --- accumulator

## 1. Challenge

```
Reverse this for the flag
```

## 2. Solution

Drop the binary to IDA and you will see the program sum each byte of SHA512 value of your input and compare each sum with values in the built-in table. 

So far so good, but the program do the same operation to your input, which means flag is hide in the built-in table. We can write a script to find it out:

```python
#!/usr/bin/env python3

table_raw = bytes.fromhex('c3000000ff000000ed010000480200001f030000a1030000b20300003e0400009c040000a00400008d0500003b0600000d0700003607000021080000100900007e0900002d0a0000a70a00009c0b00008d0c00004b0d00005a0d0000410e0000800e00006e0f0000950f000061100000841000002a110000ab11000010120000621200004713000087130000d0130000f2130000ab14000086150000a01500000c1600007716000069170000e6170000ee17000036180000431800000a19000045190000d1190000f7190000601a0000421b0000621b00008d1b0000c21b00006a1c00002c1d00008b1d0000f91d00001a1e0000141f0000d21f0000fb1f0000412000008d200000ce2000001521000090210000c0210000f521000026220000592200008c220000c5220000f92200002f2300006623000099230000c9230000ff230000652400009e240000d52400000b2500004425000077250000ac250000dc2500000d2600004026000076260000d82600000c2700003d270000a0270000d327000006280000362800006e280000a2280000d2280000372900009c290000fe290000612a0000c22a0000252b0000582b00008b2b0000c22b0000282c0000592c0000bb2c0000f32c0000552d0000852d0000e92d00004c2e00007c2e0000af2e0000142f0000492f0000812f0000e32f00004830000079300000ad3000001331000078310000ae310000e73100001732000079320000aa320000dc3200000f33000075330000ab330000dc3300003e3400006e340000d1340000013500006335000096350000cb3500003136000094360000cd3600000037000063370000c6370000293800006038000092380000c3380000f338000023390000573900008c390000c5390000f83900002e3a0000673a0000cc3a0000323b00006a3b00009f3b0000d23b0000033c0000643c0000953c0000fa3c0000323d0000933d0000ca3d00002c3e0000603e0000923e0000cb3e0000043f0000693f0000a03f0000024000003b4000009f400000d84000000f4100003f410000a1410000da4100003b4200006d420000a04200000143000062430000df430000')
table = []
for i in range(0, len(table_raw), 4):
    table.append(int.from_bytes(table_raw[i:i + 4], 'little'))

sha512 = bytearray(64)
for i in range(0, 64):
    if i == 0:
        sha512[i] = table[i]
    else:
        sha512[i] = table[i] - table[i - 1]

flag = bytearray(len(table) - 64)
for i in range(0, len(flag)):
    flag[i] = table[64 + i] - table[64 + i - 1]
print(flag.decode())
```
